<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Spanish Class â€“ Future Tenses + Vocabulary</title>

<style>
  :root{
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  }
  body{ margin:0; background:#fafafa; color:#111; }
  .wrap{ max-width: 980px; margin: 0 auto; padding: 14px; }
  .card{
    background:#fff; border:1px solid #eaeaea; border-radius: 16px;
    padding: 16px; margin: 14px 0;
    box-shadow: 0 1px 4px rgba(0,0,0,0.05);
  }
  h1{ margin:0 0 8px; font-size: 24px; line-height: 1.2; }
  h2{ margin:0 0 10px; font-size: 20px; line-height: 1.2; }
  .sub{ color:#444; font-size: 15px; line-height: 1.35; }
  .note{ color:#555; font-size: 14px; line-height: 1.4; margin-top: 6px; }

  /* Controls */
  .controls{ display:flex; flex-direction: column; gap: 12px; margin-top: 12px; }
  .controlRow{ display:grid; gap:8px; }
  label{ font-size: 14px; font-weight: 700; color:#222; }
  select, input[type="range"]{
    width:100%;
    font-size:16px;
    padding: 10px;
    border-radius: 12px;
    border:1px solid #ddd;
    background:#fff;
  }
  .btn{
    width:100%;
    font-size: 16px;
    padding: 14px 14px;
    border-radius: 14px;
    border:1px solid #111;
    background:#111;
    color:#fff;
    font-weight: 800;
    cursor:pointer;
  }
  .btn.secondary{
    border:1px solid #ddd;
    background:#fff;
    color:#111;
    font-weight: 800;
  }
  .btn.small{
    width:auto;
    padding: 10px 12px;
    font-size: 15px;
    border-radius: 12px;
  }
  .hint{ font-size: 13px; color:#666; }

  /* Lesson items */
  .item{
    border: 1px solid #eee;
    background:#fcfcfc;
    border-radius: 14px;
    padding: 14px;
    margin-top: 12px;
  }
  .sp{ font-size: 20px; font-weight: 800; line-height: 1.35; }
  .en{ font-size: 15px; color:#444; line-height: 1.35; margin-top: 6px; }
  .tools{ display:flex; flex-direction: column; gap:10px; margin-top: 12px; }
  .status{
    font-size: 14px;
    padding: 10px;
    border-radius: 12px;
    border:1px dashed #ddd;
    background:#fff;
    color:#444;
  }
  .good{ color:#0a7a2a; }
  .bad{ color:#b00020; }

  /* Vocabulary cards */
  .vocabLine{ margin-top: 6px; font-size: 14px; color:#444; line-height: 1.35; }
  .pill{
    display:inline-block;
    padding: 4px 10px;
    border:1px solid #eee;
    border-radius: 999px;
    font-size: 13px;
    color:#333;
    background:#fff;
    margin-top: 8px;
  }

  /* Desktop layout enhancement */
  @media (min-width: 900px){
    .wrap{ padding: 18px; }
    h1{ font-size: 28px; }
    h2{ font-size: 22px; }
    .sp{ font-size: 22px; }
    .controls{
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 12px;
      align-items: end;
    }
    .controls .controlRow:nth-child(3){ grid-column: 1 / span 2; }
    .controls .controlRow:nth-child(4){ grid-column: 3; }
    .tools{
      flex-direction: row;
      align-items: center;
      flex-wrap: wrap;
    }
    .btn{ width:auto; }
    .btn.secondary{ width:auto; }
  }
</style>
</head>

<body>
<div class="wrap">

  <!-- Header / Controls -->
  <div class="card">
    <h1>Spanish Class â€” Future Tenses + Vocabulary</h1>
    <div class="sub">
      Tap <b>â–¶ Speak</b> to hear Spanish. If available, the page auto-selects <b>Google EspaÃ±ol de Estados Unidos</b>.
      Use <b>ğŸ™ Repeat</b> to practice (works best in Chrome desktop).
    </div>

    <div class="controls">
      <div class="controlRow">
        <label for="voiceSelect">Voice</label>
        <select id="voiceSelect"></select>
        <div class="hint" id="voiceHint"></div>
      </div>

      <div class="controlRow">
        <label for="rate">Speed</label>
        <input id="rate" type="range" min="0.6" max="1.2" step="0.05" value="0.95">
        <div class="hint" id="rateVal">0.95Ã—</div>
      </div>

      <div class="controlRow">
        <button class="btn secondary" id="stopBtn" type="button">â–  Stop</button>
      </div>

      <div class="controlRow">
        <div class="status" id="envStatus">Ready</div>
      </div>
    </div>
  </div>

  <!-- 1) Vocabulary -->
  <div class="card">
    <h2>1) Vocabulary & Clarifications</h2>
    <div class="note">During the lesson, you clarified several cultural and linguistic terms:</div>

    <!-- Each vocab card speaks the Spanish term + (optional) a short phrase -->
    <div class="item" data-spanish="RoscÃ³n de Reyes.">
      <div class="sp">RoscÃ³n de Reyes</div>
      <div class="en"><b>English:</b> King's Cake</div>
      <div class="vocabLine">A round sweet bread eaten for Epiphany.</div>
      <div class="pill">Culture / Food</div>
      <div class="tools">
        <button class="btn speak" type="button">â–¶ Speak</button>
        <button class="btn secondary mic" type="button">ğŸ™ Repeat</button>
        <span class="status">Ready</span>
      </div>
    </div>

    <div class="item" data-spanish="Nata.">
      <div class="sp">Nata</div>
      <div class="en"><b>English:</b> Cream</div>
      <div class="vocabLine">Usually refers to whipped cream filling in a cake.</div>
      <div class="tools">
        <button class="btn speak" type="button">â–¶ Speak</button>
        <button class="btn secondary mic" type="button">ğŸ™ Repeat</button>
        <span class="status">Ready</span>
      </div>
    </div>

    <div class="item" data-spanish="Pantalla.">
      <div class="sp">Pantalla</div>
      <div class="en"><b>English:</b> Screen</div>
      <div class="vocabLine">Refers to a computer or device screen.</div>
      <div class="tools">
        <button class="btn speak" type="button">â–¶ Speak</button>
        <button class="btn secondary mic" type="button">ğŸ™ Repeat</button>
        <span class="status">Ready</span>
      </div>
    </div>

    <div class="item" data-spanish="Caber.">
      <div class="sp">Caber</div>
      <div class="en"><b>English:</b> To fit</div>
      <div class="vocabLine">Used to describe capacity (e.g., â€œIn my car five people fitâ€).</div>
      <div class="tools">
        <button class="btn speak" type="button">â–¶ Speak</button>
        <button class="btn secondary mic" type="button">ğŸ™ Repeat</button>
        <span class="status">Ready</span>
      </div>
    </div>

    <div class="item" data-spanish="Valer.">
      <div class="sp">Valer</div>
      <div class="en"><b>English:</b> To cost / To be worth</div>
      <div class="vocabLine">Used to express value or price of items or people.</div>
      <div class="tools">
        <button class="btn speak" type="button">â–¶ Speak</button>
        <button class="btn secondary mic" type="button">ğŸ™ Repeat</button>
        <span class="status">Ready</span>
      </div>
    </div>

    <div class="item" data-spanish="Siguiente. Al dÃ­a siguiente.">
      <div class="sp">Siguiente</div>
      <div class="en"><b>English:</b> Next / Following</div>
      <div class="vocabLine"><b>Al dÃ­a siguiente</b> means â€œthe next dayâ€.</div>
      <div class="tools">
        <button class="btn speak" type="button">â–¶ Speak</button>
        <button class="btn secondary mic" type="button">ğŸ™ Repeat</button>
        <span class="status">Ready</span>
      </div>
    </div>

    <div class="item" data-spanish="Sendero.">
      <div class="sp">Sendero</div>
      <div class="en"><b>English:</b> Path / Trail</div>
      <div class="vocabLine">A path through the forest (bosque).</div>
      <div class="tools">
        <button class="btn speak" type="button">â–¶ Speak</button>
        <button class="btn secondary mic" type="button">ğŸ™ Repeat</button>
        <span class="status">Ready</span>
      </div>
    </div>

    <div class="item" data-spanish="Charlar.">
      <div class="sp">Charlar</div>
      <div class="en"><b>English:</b> To chat</div>
      <div class="vocabLine">An informal way to say â€œto talkâ€ about life.</div>
      <div class="tools">
        <button class="btn speak" type="button">â–¶ Speak</button>
        <button class="btn secondary mic" type="button">ğŸ™ Repeat</button>
        <span class="status">Ready</span>
      </div>
    </div>

    <div class="item" data-spanish="Alojamiento.">
      <div class="sp">Alojamiento</div>
      <div class="en"><b>English:</b> Accommodation</div>
      <div class="vocabLine">General term for a place to stay (hotel, etc.).</div>
      <div class="tools">
        <button class="btn speak" type="button">â–¶ Speak</button>
        <button class="btn secondary mic" type="button">ğŸ™ Repeat</button>
        <span class="status">Ready</span>
      </div>
    </div>

    <div class="item" data-spanish="Sin duda.">
      <div class="sp">Sin duda</div>
      <div class="en"><b>English:</b> Without a doubt</div>
      <div class="vocabLine">Used to say â€œcertainlyâ€ or â€œobviously.â€</div>
      <div class="tools">
        <button class="btn speak" type="button">â–¶ Speak</button>
        <button class="btn secondary mic" type="button">ğŸ™ Repeat</button>
        <span class="status">Ready</span>
      </div>
    </div>

    <div class="item" data-spanish="Inolvidable.">
      <div class="sp">Inolvidable</div>
      <div class="en"><b>English:</b> Unforgettable</div>
      <div class="vocabLine">Used to describe a special or wonderful day.</div>
      <div class="tools">
        <button class="btn speak" type="button">â–¶ Speak</button>
        <button class="btn secondary mic" type="button">ğŸ™ Repeat</button>
        <span class="status">Ready</span>
      </div>
    </div>

  </div>

  <!-- 2) Periphrastic Future -->
  <div class="card">
    <h2>2) Periphrastic Future (Ir + a + Infinitive)</h2>
    <div class="note">
      Corresponds to â€œI am going to [verb]â€ and is used for near-future plans.<br>
      <b>Formula:</b> conjugated <i>ir</i> + <i>a</i> + infinitive.
    </div>

    <div class="item" data-spanish="Yo voy a cantar.">
      <div class="sp">Yo voy a cantar.</div>
      <div class="en">I am going to sing.</div>
      <div class="tools">
        <button class="btn speak" type="button">â–¶ Speak</button>
        <button class="btn secondary mic" type="button">ğŸ™ Repeat</button>
        <span class="status">Ready</span>
      </div>
    </div>

    <div class="item" data-spanish="Vamos a ir a la iglesia.">
      <div class="sp">Vamos a ir a la iglesia.</div>
      <div class="en">We are going to go to church.</div>
      <div class="tools">
        <button class="btn speak" type="button">â–¶ Speak</button>
        <button class="btn secondary mic" type="button">ğŸ™ Repeat</button>
        <span class="status">Ready</span>
      </div>
    </div>

    <div class="item" data-spanish="Vas a desayunar tostadas.">
      <div class="sp">Vas a desayunar tostadas.</div>
      <div class="en">You are going to have toast.</div>
      <div class="tools">
        <button class="btn speak" type="button">â–¶ Speak</button>
        <button class="btn secondary mic" type="button">ğŸ™ Repeat</button>
        <span class="status">Ready</span>
      </div>
    </div>

    <div class="item" data-spanish="Van a jugar al fÃºtbol.">
      <div class="sp">Van a jugar al fÃºtbol.</div>
      <div class="en">They are going to play soccer.</div>
      <div class="tools">
        <button class="btn speak" type="button">â–¶ Speak</button>
        <button class="btn secondary mic" type="button">ğŸ™ Repeat</button>
        <span class="status">Ready</span>
      </div>
    </div>
  </div>

  <!-- 3) Simple Future -->
  <div class="card">
    <h2>3) Simple Future (Futuro Simple)</h2>
    <div class="note">
      Corresponds to â€œI will [verb].â€ For regular verbs, add endings to the infinitive.
    </div>

    <div class="item" data-spanish="Las terminaciones del futuro son: Ã©, Ã¡s, Ã¡, emos, Ã©is, Ã¡n.">
      <div class="sp">Regular endings (all -ar / -er / -ir)</div>
      <div class="en"><b>Endings:</b> -Ã©, -Ã¡s, -Ã¡, -emos, -Ã©is, -Ã¡n</div>
      <div class="tools">
        <button class="btn speak" type="button">â–¶ Speak (Spanish)</button>
      </div>
    </div>

    <div class="note" style="margin-top:10px;">
      <b>Irregular verbs (special future stems)</b> â€” same endings, different stem.
      Tap â–¶ Speak to hear the whole conjugation.
    </div>

    <!-- Irregular verb cards -->
    <div class="item" data-spanish="Tener. TendrÃ©, tendrÃ¡s, tendrÃ¡, tendremos, tendrÃ©is, tendrÃ¡n.">
      <div class="sp">Tener â†’ Tendr-</div>
      <div class="en"><b>Meaning:</b> to have</div>
      <div class="en"><b>Future:</b> tendrÃ©, tendrÃ¡s, tendrÃ¡, tendremos, tendrÃ©is, tendrÃ¡n</div>
      <div class="tools">
        <button class="btn speak" type="button">â–¶ Speak</button>
      </div>
    </div>

    <div class="item" data-spanish="Venir. VendrÃ©, vendrÃ¡s, vendrÃ¡, vendremos, vendrÃ©is, vendrÃ¡n.">
      <div class="sp">Venir â†’ Vendr-</div>
      <div class="en"><b>Meaning:</b> to come</div>
      <div class="en"><b>Future:</b> vendrÃ©, vendrÃ¡s, vendrÃ¡, vendremos, vendrÃ©is, vendrÃ¡n</div>
      <div class="tools">
        <button class="btn speak" type="button">â–¶ Speak</button>
      </div>
    </div>

    <div class="item" data-spanish="Poner. PondrÃ©, pondrÃ¡s, pondrÃ¡, pondremos, pondrÃ©is, pondrÃ¡n.">
      <div class="sp">Poner â†’ Pondr-</div>
      <div class="en"><b>Meaning:</b> to put</div>
      <div class="en"><b>Future:</b> pondrÃ©, pondrÃ¡s, pondrÃ¡, pondremos, pondrÃ©is, pondrÃ¡n</div>
      <div class="tools">
        <button class="btn speak" type="button">â–¶ Speak</button>
      </div>
    </div>

    <div class="item" data-spanish="Poder. PodrÃ©, podrÃ¡s, podrÃ¡, podremos, podrÃ©is, podrÃ¡n.">
      <div class="sp">Poder â†’ Podr-</div>
      <div class="en"><b>Meaning:</b> to be able to / can</div>
      <div class="en"><b>Future:</b> podrÃ©, podrÃ¡s, podrÃ¡, podremos, podrÃ©is, podrÃ¡n</div>
      <div class="tools">
        <button class="btn speak" type="button">â–¶ Speak</button>
      </div>
    </div>

    <div class="item" data-spanish="Salir. SaldrÃ©, saldrÃ¡s, saldrÃ¡, saldremos, saldrÃ©is, saldrÃ¡n.">
      <div class="sp">Salir â†’ Saldr-</div>
      <div class="en"><b>Meaning:</b> to leave / go out</div>
      <div class="en"><b>Future:</b> saldrÃ©, saldrÃ¡s, saldrÃ¡, saldremos, saldrÃ©is, saldrÃ¡n</div>
      <div class="tools">
        <button class="btn speak" type="button">â–¶ Speak</button>
      </div>
    </div>

    <div class="item" data-spanish="Hacer. HarÃ©, harÃ¡s, harÃ¡, haremos, harÃ©is, harÃ¡n.">
      <div class="sp">Hacer â†’ Har-</div>
      <div class="en"><b>Meaning:</b> to do / make</div>
      <div class="en"><b>Future:</b> harÃ©, harÃ¡s, harÃ¡, haremos, harÃ©is, harÃ¡n</div>
      <div class="tools">
        <button class="btn speak" type="button">â–¶ Speak</button>
      </div>
    </div>

    <div class="item" data-spanish="Saber. SabrÃ©, sabrÃ¡s, sabrÃ¡, sabremos, sabrÃ©is, sabrÃ¡n.">
      <div class="sp">Saber â†’ Sabr-</div>
      <div class="en"><b>Meaning:</b> to know (a fact)</div>
      <div class="en"><b>Future:</b> sabrÃ©, sabrÃ¡s, sabrÃ¡, sabremos, sabrÃ©is, sabrÃ¡n</div>
      <div class="tools">
        <button class="btn speak" type="button">â–¶ Speak</button>
      </div>
    </div>

    <div class="item" data-spanish="Querer. QuerrÃ©, querrÃ¡s, querrÃ¡, querremos, querrÃ©is, querrÃ¡n.">
      <div class="sp">Querer â†’ Querr-</div>
      <div class="en"><b>Meaning:</b> to want / to love</div>
      <div class="en"><b>Future:</b> querrÃ©, querrÃ¡s, querrÃ¡, querremos, querrÃ©is, querrÃ¡n</div>
      <div class="tools">
        <button class="btn speak" type="button">â–¶ Speak</button>
      </div>
    </div>
  </div>

  <!-- 4) Practice answers -->
  <div class="card">
    <h2>4) Practice Exercise Answers</h2>
    <div class="note">Spanish translations for the practice exercises provided previously:</div>

    <div class="item" data-spanish="El prÃ³ximo aÃ±o, tendrÃ© mÃ¡s dinero.">
      <div class="sp">El prÃ³ximo aÃ±o, tendrÃ© mÃ¡s dinero.</div>
      <div class="en"><b>English:</b> Next year, I will have more money.</div>
      <div class="tools">
        <button class="btn speak" type="button">â–¶ Speak</button>
        <button class="btn secondary mic" type="button">ğŸ™ Repeat</button>
        <span class="status">Ready</span>
      </div>
    </div>

    <div class="item" data-spanish="Este fin de semana, vamos a viajar.">
      <div class="sp">Este fin de semana, vamos a viajar.</div>
      <div class="en"><b>English:</b> This weekend, we are going to travel.</div>
      <div class="tools">
        <button class="btn speak" type="button">â–¶ Speak</button>
        <button class="btn secondary mic" type="button">ğŸ™ Repeat</button>
        <span class="status">Ready</span>
      </div>
    </div>

    <div class="item" data-spanish="Ellos saldrÃ¡n de casa a las ocho.">
      <div class="sp">Ellos saldrÃ¡n de casa a las ocho.</div>
      <div class="en"><b>English:</b> They will leave the house at 8:00.</div>
      <div class="tools">
        <button class="btn speak" type="button">â–¶ Speak</button>
        <button class="btn secondary mic" type="button">ğŸ™ Repeat</button>
        <span class="status">Ready</span>
      </div>
    </div>

    <div class="item" data-spanish="Yo voy a aprender espaÃ±ol.">
      <div class="sp">Yo voy a aprender espaÃ±ol.</div>
      <div class="en"><b>English:</b> I am going to learn Spanish.</div>
      <div class="tools">
        <button class="btn speak" type="button">â–¶ Speak</button>
        <button class="btn secondary mic" type="button">ğŸ™ Repeat</button>
        <span class="status">Ready</span>
      </div>
    </div>
  </div>

  <div class="card">
    <h2>Notes</h2>
    <ul class="note">
      <li>If the voice dropdown is empty, your embed environment is blocking Web Speech voices. Open the page directly (GitHub Pages) for best results.</li>
      <li>Chrome desktop supports mic practice best.</li>
    </ul>
  </div>

</div>

<script>
  // Preferred voice fragments:
  // We will auto-select a voice whose name includes these words (in any case).
  const PREFERRED_VOICE_PARTS = ["google", "espaÃ±ol", "estados unidos"];

  const voiceSelect = document.getElementById("voiceSelect");
  const rate = document.getElementById("rate");
  const rateVal = document.getElementById("rateVal");
  const stopBtn = document.getElementById("stopBtn");
  const voiceHint = document.getElementById("voiceHint");
  const envStatus = document.getElementById("envStatus");

  function normalizeForMatch(s) {
    return (s || "")
      .toLowerCase()
      .trim()
      .replace(/[Â¡!Â¿?.,;:()"]/g, "")
      .normalize("NFD").replace(/[\u0300-\u036f]/g, "") // remove accents
      .replace(/\s+/g, " ");
  }

  function voiceNameMatchesPreferred(name) {
    const n = (name || "").toLowerCase();
    return PREFERRED_VOICE_PARTS.every(p => n.includes(p));
  }

  function loadVoicesAndAutoSelect() {
    const voices = window.speechSynthesis?.getVoices?.() || [];
    voiceSelect.innerHTML = "";

    voices.forEach(v => {
      const opt = document.createElement("option");
      opt.value = v.name;
      opt.textContent = `${v.name} (${v.lang})`;
      voiceSelect.appendChild(opt);
    });

    const preferred = voices.find(v => voiceNameMatchesPreferred(v.name));
    const esUS = voices.find(v => (v.lang || "").toLowerCase() === "es-us");
    const spanish = voices.find(v => (v.lang || "").toLowerCase().startsWith("es"));
    const chosen = preferred || esUS || spanish || voices[0] || null;

    if (chosen) {
      voiceSelect.value = chosen.name;
      voiceHint.textContent = preferred ? `âœ“ Preferred voice selected: ${chosen.name}` : `Voice: ${chosen.name}`;
      envStatus.textContent = "Ready";
    } else {
      voiceHint.textContent = "No voices found in this browser environment.";
      envStatus.textContent = "No voices available";
    }

    // If embedded environments block voices, this often stays empty.
    setTimeout(() => {
      const v2 = window.speechSynthesis?.getVoices?.() || [];
      if (!v2.length) {
        envStatus.textContent = "No voices here (embed restriction). Open the page directly.";
      }
    }, 800);
  }

  function getSelectedVoice() {
    const voices = window.speechSynthesis?.getVoices?.() || [];
    return voices.find(v => v.name === voiceSelect.value) || null;
  }

  function speak(text) {
    if (!window.speechSynthesis) return;
    window.speechSynthesis.cancel();

    const u = new SpeechSynthesisUtterance(text);
    u.rate = parseFloat(rate.value);

    const chosen = getSelectedVoice();
    if (chosen) {
      u.voice = chosen;
      u.lang = chosen.lang || "es-US";
    } else {
      u.lang = "es-US";
    }
    window.speechSynthesis.speak(u);
  }

  // Speed label
  rate.addEventListener("input", () => {
    rateVal.textContent = `${rate.value}Ã—`;
  });

  stopBtn.addEventListener("click", () => window.speechSynthesis?.cancel?.());

  if (window.speechSynthesis) {
    loadVoicesAndAutoSelect();
    window.speechSynthesis.onvoiceschanged = loadVoicesAndAutoSelect;
  }

  // Attach Speak buttons everywhere we have data-spanish
  document.querySelectorAll("[data-spanish]").forEach(node => {
    const speakBtn = node.querySelector(".speak");
    if (speakBtn) speakBtn.addEventListener("click", () => speak(node.dataset.spanish));
  });

  // Speech Recognition (optional)
  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
  const recognitionSupported = !!SpeechRecognition;

  function setStatus(node, html, cls) {
    const el = node.querySelector(".status");
    if (!el) return;
    el.className = "status " + (cls || "");
    el.innerHTML = html;
  }

  function listenAndCheck(node) {
    if (!recognitionSupported) {
      setStatus(node, "Speech recognition not supported here.", "bad");
      return;
    }

    const target = node.dataset.spanish || "";
    const targetNorm = normalizeForMatch(target);

    const rec = new SpeechRecognition();
    rec.lang = "es-US";
    rec.interimResults = false;
    rec.maxAlternatives = 1;

    setStatus(node, "Listeningâ€¦ speak now.", "");

    rec.onresult = (e) => {
      const heard = e.results[0][0].transcript || "";
      const heardNorm = normalizeForMatch(heard);

      const ok = (heardNorm === targetNorm) ||
                 (heardNorm.includes(targetNorm)) ||
                 (targetNorm.includes(heardNorm) && heardNorm.length > 6);

      if (ok) {
        setStatus(node, `Heard: â€œ${heard}â€ <span class="good"><b>âœ“ Nice!</b></span>`, "");
      } else {
        setStatus(node, `Heard: â€œ${heard}â€ <span class="bad"><b>âœ— Try again</b></span><br><span class="hint">Expected: â€œ${target}â€</span>`, "");
      }
    };

    rec.onerror = (e) => setStatus(node, `Mic error: ${e.error || "unknown"}`, "bad");
    rec.start();
  }

  // Attach mic buttons
  document.querySelectorAll("[data-spanish]").forEach(node => {
    const micBtn = node.querySelector(".mic");
    if (!micBtn) return;

    if (!recognitionSupported) {
      micBtn.disabled = true;
      micBtn.textContent = "ğŸ™ Repeat (not supported)";
      micBtn.classList.add("secondary");
    } else {
      micBtn.addEventListener("click", () => listenAndCheck(node));
    }
  });
</script>
</body>
</html>
